<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Vibematch Arena</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <!-- Loading screen -->
        <div id="loadingScreen" class="loading-screen">
            <h1>VIBEMATCH ARENA</h1>
            <div class="loading-bar">
                <div id="loadingProgress" class="loading-progress"></div>
            </div>
            <p id="loadingText">Loading assets...</p>
        </div>

        <!-- Menu no longer needed - auto-load as spectator -->
        <div id="menu" class="menu" style="display: none"></div>

        <div id="game" class="game" style="display: none">
            <canvas id="gameCanvas"></canvas>

            <!-- Spectator overlay with join button -->
            <div id="spectatorOverlay" class="spectator-overlay">
                <button id="joinButton" class="join-button-spectator">
                    JOIN GAME
                </button>
            </div>

            <div id="hud" class="hud">
                <div class="hud-center">
                    <div id="crosshair" class="crosshair"></div>
                </div>

                <!-- Bottom HUD elements removed - using mod system for HUD -->
            </div>

            <div id="scoreboard" class="scoreboard">
                <h3>SCOREBOARD</h3>
                <div id="scoreboardContent"></div>
            </div>

            <div id="killfeed" class="killfeed"></div>

            <div
                id="respawnMessage"
                class="respawn-message"
                style="display: none"
            >
                <p>YOU DIED</p>
                <span id="respawnTimer"></span>
            </div>

            <!-- In-game menu (ESC to toggle) -->
            <div id="gameMenu" class="game-menu" style="display: none">
                <div class="game-menu-content">
                    <h2>GAME MENU</h2>
                    <div class="menu-hint">Press M to close</div>

                    <!-- Resume Game button -->
                    <div class="game-menu-section">
                        <button id="resumeGameButton" class="menu-btn">
                            Resume Game
                        </button>
                    </div>

                    <!-- Single tab content - no tab navigation needed -->
                    <div class="game-menu-section">
                        <h3>Player Name</h3>
                        <input
                            type="text"
                            id="playerNameInput"
                            maxlength="20"
                            placeholder="Enter your name"
                        />
                        <button id="saveNameButton" class="menu-btn">
                            Save Name
                        </button>
                    </div>

                    <div class="game-menu-section">
                        <h3>Game Mode</h3>
                        <div
                            id="gameModeDisplay"
                            style="
                                margin-bottom: 10px;
                                color: #66ccff;
                                font-weight: bold;
                            "
                        >
                            Current: Vibe Royale
                        </div>
                        <div
                            style="
                                display: flex;
                                gap: 10px;
                                margin-bottom: 10px;
                            "
                        >
                            <button
                                id="voteVibematchButton"
                                class="menu-btn"
                                style="flex: 1"
                            >
                                Vote Vibematch
                            </button>
                            <button
                                id="voteVibeRoyaleButton"
                                class="menu-btn"
                                style="flex: 1"
                            >
                                Vote Vibe Royale
                            </button>
                        </div>
                        <div
                            id="voteCountsDisplay"
                            style="font-size: 12px; color: #888"
                        >
                            Votes: Vibematch (0) | Vibe Royale (0)
                        </div>
                    </div>

                    <div class="game-menu-section">
                        <button id="spectateButton" class="menu-btn">
                            Enter Spectate Mode
                        </button>
                    </div>

                    <div class="game-menu-section">
                        <button id="controlsButton" class="menu-btn">
                            Controls & How to Play
                        </button>
                    </div>

                    <div class="game-menu-section">
                        <button id="debugHudButton" class="menu-btn">
                            <span id="debugHudButtonText"
                                >Enable Debug HUD</span
                            >
                        </button>
                        <div
                            class="menu-hint"
                            style="font-size: 11px; margin-top: 5px"
                        >
                            Monitors FPS, memory leaks, and performance
                        </div>
                    </div>

                    <div class="game-menu-section">
                        <button id="levelEditorButton" class="menu-btn">
                            Level Editor
                        </button>
                    </div>
                </div>
            </div>

            <!-- Controls/How to Play screen -->
            <div id="controlsScreen" class="game-menu" style="display: none">
                <div class="game-menu-content controls-screen">
                    <h2>CONTROLS & HOW TO PLAY</h2>
                    <div class="menu-hint">Press M to close</div>

                    <div class="controls-grid">
                        <div class="control-section">
                            <h3>Movement</h3>
                            <div class="control-item">
                                <span class="key">W</span>
                                <span>Move Up</span>
                            </div>
                            <div class="control-item">
                                <span class="key">A</span>
                                <span>Move Left</span>
                            </div>
                            <div class="control-item">
                                <span class="key">S</span>
                                <span>Move Down</span>
                            </div>
                            <div class="control-item">
                                <span class="key">D</span>
                                <span>Move Right</span>
                            </div>
                        </div>

                        <div class="control-section">
                            <h3>Combat</h3>
                            <div class="control-item">
                                <span class="key">LEFT CLICK</span>
                                <span>Shoot</span>
                            </div>
                            <div class="control-item">
                                <span class="key">MOUSE</span>
                                <span>Aim Direction</span>
                            </div>
                            <div class="control-item">
                                <span class="key">R</span>
                                <span>Reload Weapon</span>
                            </div>
                        </div>

                        <div class="control-section">
                            <h3>General</h3>
                            <div class="control-item">
                                <span class="key">M</span>
                                <span>Toggle Menu</span>
                            </div>
                            <div class="control-item">
                                <span class="key">`</span>
                                <span>Mod Editor</span>
                            </div>
                            <div class="control-item">
                                <span class="key">F3</span>
                                <span>Debug HUD</span>
                            </div>
                            <div class="control-item">
                                <span class="key">TAB</span>
                                <span>Leaderboard</span>
                            </div>
                            <div class="control-item">
                                <span class="key">B</span>
                                <span>Mod Shop</span>
                            </div>
                        </div>

                        <div class="control-section full-width">
                            <h3>Objective</h3>
                            <p class="objective-text">
                                Eliminate opponents to score kills. Walk over
                                weapon pickups to collect them (one weapon at a
                                time). Gather health, armor, and ammo pickups
                                scattered around the map. Different weapons have
                                different ranges and damage values. Manage your
                                ammo and reload strategically. Top the
                                leaderboard!
                            </p>
                        </div>
                    </div>

                    <button id="closeControlsButton" class="menu-btn back-btn">
                        Back to Menu
                    </button>
                </div>
            </div>
        </div>

        <!-- Level Editor -->
        <div id="levelEditor" class="level-editor" style="display: none">
            <div class="level-editor-header">
                <h2>LEVEL EDITOR</h2>
                <div class="level-editor-tools">
                    <input
                        type="text"
                        id="levelNameInput"
                        placeholder="Level Name"
                        maxlength="30"
                    />
                    <button id="saveLevelButton" class="editor-btn">
                        Save Level
                    </button>
                    <button id="loadLevelButton" class="editor-btn">
                        Load Level
                    </button>
                    <button id="newLevelButton" class="editor-btn">
                        New Level
                    </button>
                    <button id="exitEditorButton" class="editor-btn exit-btn">
                        Exit Editor
                    </button>
                </div>
            </div>

            <div class="level-editor-main">
                <div class="level-editor-sidebar">
                    <h3>Tools</h3>
                    <div class="tool-section">
                        <h4>Mode</h4>
                        <button
                            id="toolWall"
                            class="tool-btn active"
                            data-tool="wall"
                        >
                            Wall
                        </button>
                        <button
                            id="toolCrate"
                            class="tool-btn"
                            data-tool="crate"
                        >
                            Crate
                        </button>
                        <button
                            id="toolSpawn"
                            class="tool-btn"
                            data-tool="spawn"
                        >
                            Spawn Point
                        </button>
                        <button
                            id="toolPickup"
                            class="tool-btn"
                            data-tool="pickup"
                        >
                            Pickup
                        </button>
                        <button
                            id="toolWaypoint"
                            class="tool-btn"
                            data-tool="waypoint"
                        >
                            Waypoint
                        </button>
                        <button
                            id="toolDelete"
                            class="tool-btn"
                            data-tool="delete"
                        >
                            Delete
                        </button>
                    </div>

                    <div class="tool-section">
                        <h4>Pickup Type</h4>
                        <select id="pickupTypeSelect">
                            <option value="health_small">Health (Small)</option>
                            <option value="health_big">Health (Big)</option>
                            <option value="armor_light">Armor (Light)</option>
                            <option value="armor_heavy">Armor (Heavy)</option>
                        </select>
                    </div>

                    <div class="tool-section">
                        <h4>Map Settings</h4>
                        <label>
                            Width:
                            <input
                                type="number"
                                id="mapWidthInput"
                                value="2000"
                                min="1000"
                                max="5000"
                                step="100"
                            />
                        </label>
                        <label>
                            Height:
                            <input
                                type="number"
                                id="mapHeightInput"
                                value="2000"
                                min="1000"
                                max="5000"
                                step="100"
                            />
                        </label>
                    </div>

                    <div class="tool-section">
                        <h4>Saved Levels</h4>
                        <div id="savedLevelsList" class="saved-levels-list">
                            Loading...
                        </div>
                    </div>
                </div>

                <div class="level-editor-canvas-container">
                    <canvas id="editorCanvas"></canvas>
                    <div class="editor-help">
                        <p>
                            Click and drag to create walls | Click to place
                            objects | Right-click to delete
                        </p>
                        <p>Camera: Arrow keys or WASD | Zoom: Mouse wheel</p>
                    </div>
                </div>
            </div>
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script type="module" src="game.js"></script>
    </body>
</html>
